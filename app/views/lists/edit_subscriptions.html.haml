= render 'page_header'

.col-lg-8.col-md-9
  .panel.panel-info
    .panel-heading Subscriptions
    .panel-body
      %table.table
        %thead
          %tr 
            %th email
            %th fingerprint
        %tbody
          - @list.subscriptions.each do |subscription|
            %tr{style: subscription.admin? && 'font-weight: bold'}
              %td{title: table_row_title(subscription)}
                = link_to(edit_subscription_path(subscription), title: 'Edit') do
                  - if subscription.delivery_enabled?
                    = subscription.email
                  - else
                    - surround('(', ')') do
                      = subscription.email
              %td
                - if subscription.fingerprint.blank?
                  %span.text-danger No fingerprint stored!
                - elsif subscription.key.blank?
                  %tt= subscription.fingerprint
                  %span.text-danger Key not present!
                  %span
                    = link_to(list_keys_new_path(@list), title: 'Upload key', class: 'text-success') do
                      .large.glyphicon.glyphicon-upload
                - elsif subscription.key.trust_issues.present?
                  %tt= link_to subscription.fingerprint, list_key_path(@list, subscription.key)
                  %span.text-danger= subscription.key.trust_issues
                - else
                  %tt= link_to subscription.fingerprint, list_key_path(@list, subscription.key)
      .small.pull-right
        * (Delivery is disabled)
        %div{style: 'font-weight: bold'} * Admin of list

.col-lg-4.col-md-5
  .panel.panel-info
    .panel-heading New subscription
    .panel-body
      = render 'subscriptions/form'
